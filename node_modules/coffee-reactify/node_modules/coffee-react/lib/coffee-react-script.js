// Generated by CoffeeScript 1.7.1
var CoffeeScript, csCompile, fs, helpers, transform;

fs = require('fs');

transform = require('coffee-react-transform');

helpers = require('./helpers');

CoffeeScript = require('coffee-script/lib/coffee-script/coffee-script');

CoffeeScript.FILE_EXTENSIONS.push('.csx', '.cjsx');

CoffeeScript.register = function() {
  return require('./register');
};

csCompile = CoffeeScript.compile;

CoffeeScript.compile = function(code, options) {
  var input;
  input = helpers.hasCJSXPragma && transform(code) || code;
  return csCompile(input, options);
};

CoffeeScript._compileFile = function(filename, sourceMap) {
  var answer, err, input, raw, stripped;
  if (sourceMap == null) {
    sourceMap = false;
  }
  raw = fs.readFileSync(filename, 'utf8');
  stripped = raw.charCodeAt(0) === 0xFEFF ? raw.substring(1) : raw;
  input = helpers.hasCJSXExtension(filename) && transform(stripped) || stripped;
  try {
    answer = CoffeeScript.compile(input, {
      filename: filename,
      sourceMap: sourceMap,
      literate: helpers.isLiterate(filename)
    });
  } catch (_error) {
    err = _error;
    throw helpers.updateSyntaxError(err, input, filename);
  }
  return answer;
};

CoffeeScript.hasCJSXPragma = helpers.hasCJSXPragma;

CoffeeScript.hasCJSXExtension = helpers.hasCJSXExtension;

CoffeeScript.transform = transform;

module.exports = CoffeeScript;
